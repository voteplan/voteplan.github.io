<!DOCTYPE html>

<html>
    <head>
		<script>
			var heading = 'Hobart City Council Election 2018';
			var subheading = 'Councillors';
            var candidates = [
'ALEXANDER, Darren',
'ALLARDICE, Robin',
'BEHRAKIS, Simon',
'BLOOMFIELD, Louise',
'BRISCOE, Jeff',
'BURNET, Helen',
'CHRISTIE, Ron',
'COATS, Will',
'CORR, Brian',
'DENISON, Tanya',
'DUT, Salpha',
'DUTTA, Mike',
'EWIN, Holly',
'FRAME, Nigel',
'HARVEY, Bill',
'IRWIN, Fiona',
'McCALLUM, Stephen',
'MALLETT, Robert',
'MERRIDEW, Chris',
'NGOR, Atak',
'PEELMAN, Ben',
'REYNOLDS, Anna',
'ROFFE, Richard',
'SCHOFIELD, Cat',
'SEXTON, Peter',
'SHERLOCK, Zelinda',
'SIENA, Kasha',
'STANAWAY, Glen',
'STANSFIELD, Philip',
'TANG, Yongbei',
'TAYLOR, Andy (Tubes)',
'TAYLOR, Bec',
'THOMAS, Damon',
'VOGEL, Stefan',
'WALDHOFF, Martin',
'ZUCCO, Marti'
            ]
			
		var deputyLordMayorCandidates = [
'ALLARDICE, Robin',
'BEHRAKIS, Simon',
'BLOOMFIELD, Louise',
'BURNET, Helen',
'COATS, Will',
'MERRIDEW, Chris',
'ROFFE, Richard',
'SHERLOCK, Zelinda',
'STANSFIELD, Philip',
'TAYLOR, Andy (Tubes)',
'WALDHOFF, Martin'
        ]
		
		var lordMayorCandidates = [
'ALEXANDER, Darren',
'BRISCOE, Jeff',
'CHRISTIE, Ron',
'DENISON, Tanya',
'DUTTA, Mike',
'HARVEY, Bill',
'MALLETT, Robert',
'REYNOLDS, Anna',
'SEXTON, Peter',
'THOMAS, Damon',
'ZUCCO, Marti'
        ]
		</script>

        <script
            src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E="
            crossorigin="anonymous"></script>

        <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.6.1/Sortable.min.js"></script>

        <link href="https://fonts.googleapis.com/css?family=Open+Sans:600" rel="stylesheet">

        <style>
* {
    font-family: 'Open Sans', sans-serif;
    color: #111;
}

body {
    background-color: #eee;
    text-align: center;
}

h1 {
    margin-top: 20px;
    margin-bottom: 0;
    margin-left: 40px;
    font-size: 19px;
}

h2 {
    margin-top: 0;
    margin-bottom: 0;
    margin-left: 40px;
    font-size: 24px;
    margin-bottom: 10px;
}

h3 {
	margin: 0;
}

ol#items {
    display: inline-block;
    margin-bottom: 30px;
    margin-right: auto;
    margin-left: auto;
}

ol#items li {
    text-align: left;
    padding: 4px 8px;
    border: 1px solid #bbb;
    cursor: move;
    cursor: grab;
    background-color: #fff;
    width: 470px;
	white-space: nowrap;
}

.toggle {
    background-color: #ddd !important;;
}

.toggle-span:before {
    content: "âœ” ";
}

.ghost {
    background-color: #888 !important;
    position: relative;
}

.hovering {
    background-color: #bbb !important;
}

.instructions {
    width: 400px;
    margin: 0 auto;
    text-align: left;
}

.instructions-list {
	margin-top: 10px;
}

input {
    width: 270px;
    margin-left: 10px;
    float: right;
}

ol#lordMayorCandidatesList li, ol#deputyLordMayorCandidatesList li {
    text-align: left;
    width: 470px;
}


ol#lordMayorCandidatesList, ol#deputyLordMayorCandidatesList {
    display: inline-block;
	
}
        </style>
		
		<title>VotePlan - Hobart City Council Election 2018 - Councillors</title>
    </head>

    <body>

        <h1 id="heading"></h1>
        <h2 id="subheading"></h2>

        <div class="instructions">
            <h3>Instructions:</h3>
            <ul class="instructions-list">
                <li>Drag names to order them.</li>
                <li>Click names to toggle tick.</li>
                <li>Use the text boxes to add notes.</li>
			</ul>
			<p>Send feedback to <a href="mailto:programming4politics@protonmail.com">programming4politics@protonmail.com</a></p>
        </div>

        <ol id="items"></ol>
		
		<h3>Lord Mayor candidates in order above</h3>
		
		<ol id="lordMayorCandidatesList"></ol>
		
		<h3>Deputy Lord Mayor candidates in order above</h3>
		
		<ol id="deputyLordMayorCandidatesList"></ol>
		
        <script>
$(document).prop('title', 'VotePlan - ' + heading + ' - ' + subheading);

$('#heading').text(heading);
$('#subheading').text(subheading);

var items = $('#items')
$.each(candidates, function(i) {
    var li = $('<li/>')
        .appendTo(items);
    var input = $('<input/>')
        .addClass('notes')
        .attr('placeholder', 'Notes')
        .appendTo(li);
    var span = $('<span/>')
        .addClass('name')
        .text(candidates[i])
        .appendTo(li);
});

var el = document.getElementById('items');
var canHover = true;
var sortable = Sortable.create(el, {
    ghostClass: 'ghost',
    onEnd: function (evt) {
        $('ol#items li').each(function (index) {
            var newIndex = index + 1 + '.';
            $(this).find('.index').html(newIndex);
        });
        canHover = true;
		
		generateLists();
    },     
    onChoose: function (evt) {
        canHover = false;
        $('ol#items li').removeClass('hovering');
    },
});
$('ol#items li').on('click', function(e){
	if (!$(e.target).hasClass('notes')) {
		$(this).toggleClass('toggle');
		$(this).children('span').first().toggleClass('toggle-span');
	}
    canHover = true;
});

$('.notes').focus(function(){
    canHover = true;
});

$('ol#items li').bind('mouseenter', function(){
    if (canHover) {
        $(this).addClass('hovering');
    }
}).bind('mouseleave', function(){
    $(this).removeClass('hovering');
});

document.documentElement.addEventListener('mouseup', function(e){
	canHover = true;
});

function generateLists() {		
	var newLordMayorList = $('<ol/>').attr('id', 'lordMayorCandidatesList');
	var newDeputyLordMayorList = $('<ol/>').attr('id', 'deputyLordMayorCandidatesList');	
	$('ol#items li').each(function() {
		if (lordMayorCandidates.includes($(this).text())) {
			$('<li/>').text($(this).text()).appendTo(newLordMayorList);
		}
		if (deputyLordMayorCandidates.includes($(this).text())) {
			$('<li/>').text($(this).text()).appendTo(newDeputyLordMayorList);
		}
	});
	
	$('#lordMayorCandidatesList').replaceWith(newLordMayorList);
	$('#deputyLordMayorCandidatesList').replaceWith(newDeputyLordMayorList);
}

generateLists();

        </script>
        <body>
</html>
